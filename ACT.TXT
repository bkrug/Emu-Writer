       DEF  UPUPSP,DOWNSP
*
       REF  LINLST
       REF  PARINX,CHRPAX,LININX

UPUPSP MOV  R11,R12
* Let R3 = Address of paragraph
       MOV  @PARINX,R3
       BL   @PARADR
* Let R4 = Wrap list address
       MOV  R3,R4
	   INCT R4
	   MOV  *R4,R4
* Let R5 = address after wrap list
       MOV  *R4,R5
	   SLA  R5,1
	   A    R4,R5
	   C    *R5+,*R5+
* Let R4 = first element address
       C    *R4+,*R4+
* Let R5 point to previous line break
UPSP5  C    R5,R4
       JEQ  UPSP7
	   DECT R5
       C    *R5,@CHRPAX
	   JH   UPSP5
* Let R6 = length previous line
       MOV  *R5,R6
       C    R5,R4
       JEQ  UPSP6
       DECT R5
	   S    *R5,R6
* Decrease CHRPAX
UPSP6  S    R6,@CHRPAX
*
       B    *R12

* Move to previous paragraph
UPSP7  DEC  @PARINX
*
       MOV  @PARINX,R3
	   BL   @PARADR
* Let R4 = Wrap list address
       MOV  R3,R4
	   INCT R4
	   MOV  *R4,R4
* Let R5 = address after wrap list
       MOV  *R4,R5
	   SLA  R5,1
	   A    R4,R5
	   C    *R5+,*R5+
*
       DECT R5
	   A    *R5,@CHRPAX
*
       B    *R12



DOWNSP RT

*
* Get paragraph address from index
*
* Input:
* R3 - paragraph index
* Output:
* R3 - paragraph address
PARADR SLA  R3,1
       A    @LINLST,R3
       C    *R3+,*R3+
       MOV  *R3,R3
       RT

       END